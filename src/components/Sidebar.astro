---
import type { Category } from "../lib/types";

interface CategoryNav {
  label: string;
  value: string;
  count: number;
}

interface Props {
  categories: CategoryNav[];
  totalReleases: number;
  thisMonthCount: number;
  latestVersion: string;
}

const { categories, totalReleases, thisMonthCount, latestVersion } = Astro.props;
---
<aside class="sidebar">
  <div class="logo">
    <span class="material-symbols-sharp logo-icon">terminal</span>
    <span class="logo-text">Claude Code News</span>
  </div>
  <span class="sidebar-label"><span class="sidebar-connector">└</span> Release Notes</span>

  <nav class="category-nav">
    <ul>
      <li>
        <button class="nav-item active" data-category="all">
          <span class="nav-label">All Releases</span>
          <span class="nav-count">{totalReleases}</span>
        </button>
      </li>
      {categories.map((cat) => (
        <li>
          <button class="nav-item" data-category={cat.value}>
            <span class="nav-label">{cat.label}</span>
            <span class="nav-count">{cat.count}</span>
          </button>
        </li>
      ))}
    </ul>
  </nav>

  <div class="stats-box">
    <div class="stat">
      <span class="stat-value stat-green">{thisMonthCount}</span>
      <span class="stat-label">This Month</span>
    </div>
    <div class="stat">
      <span class="stat-value">{totalReleases}</span>
      <span class="stat-label">Total Releases</span>
    </div>
    <div class="stat">
      <span class="stat-value">{latestVersion}</span>
      <span class="stat-label">Latest Version</span>
    </div>
  </div>

  <a href="https://pencil.dev" target="_blank" rel="noopener noreferrer" class="pencil-attribution">
    <span class="pencil-label">Designed with</span>
    <img src="/images/pencil-logo.svg" alt="Pencil" class="pencil-logo" />
    <span class="pencil-vibes"><span class="pencil-connector">└</span> (and vibes)</span>
  </a>
</aside>

<style>
  .sidebar {
    position: fixed;
    top: 0;
    left: 0;
    width: var(--sidebar-width);
    height: 100vh;
    background: var(--color-surface);
    border-right: 1px solid var(--color-border);
    padding: 24px 16px;
    display: flex;
    flex-direction: column;
    overflow-y: auto;
  }

  .logo {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 4px;
  }

  .logo-icon {
    font-size: 28px;
    color: var(--color-accent);
  }

  .logo-text {
    font-family: var(--font-heading);
    font-size: 20px;
    font-weight: 700;
  }

  .sidebar-label {
    font-size: 13px;
    color: var(--color-text-muted);
    margin-bottom: 24px;
    padding-left: 38px;
  }

  .sidebar-connector {
    color: var(--color-text-muted);
    margin-right: 4px;
  }

  .category-nav {
    flex: 1;
  }

  .category-nav ul {
    display: flex;
    flex-direction: column;
    gap: 2px;
  }

  .nav-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    padding: 10px 12px;
    border: none;
    border-radius: 8px;
    background: transparent;
    color: var(--color-text-muted);
    font-family: var(--font-body);
    font-size: 14px;
    cursor: pointer;
    transition: background 0.15s, color 0.15s;
  }

  .nav-item:hover {
    background: var(--color-surface-hover);
    color: var(--color-text);
  }

  .nav-item.active {
    background: var(--color-accent-dim);
    color: var(--color-accent);
  }

  .nav-count {
    font-size: 12px;
    font-weight: 600;
    min-width: 24px;
    text-align: center;
  }

  .stats-box {
    margin-top: 24px;
    padding: 16px;
    background: var(--color-bg);
    border-radius: 10px;
    border: 1px solid var(--color-border);
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .stat {
    display: flex;
    flex-direction: column;
    gap: 2px;
  }

  .stat-value {
    font-family: var(--font-heading);
    font-size: 18px;
    font-weight: 600;
  }

  .stat-green {
    color: #22c55e;
  }

  .stat-label {
    font-size: 12px;
    color: var(--color-text-muted);
  }

  .pencil-attribution {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: 6px;
    margin-top: 16px;
    padding: 12px;
    border-radius: 8px;
    text-decoration: none;
    transition: background 0.15s;
  }

  .pencil-attribution:hover {
    background: var(--color-surface-hover);
  }

  .pencil-label {
    font-size: 11px;
    color: var(--color-accent);
    letter-spacing: 0.02em;
  }

  .pencil-vibes {
    font-family: 'Indie Flower', cursive;
    font-size: 15px;
    font-weight: 600;
    color: var(--color-accent);
    align-self: flex-start;
  }

  .pencil-connector {
    color: var(--color-text-muted);
    margin-right: 4px;
  }

  .pencil-logo {
    height: 18px;
    width: auto;
    opacity: 0.7;
    transition: opacity 0.15s;
  }

  .pencil-attribution:hover .pencil-logo {
    opacity: 1;
  }
</style>
